---
title: "Homework 5"
author: "Lisa Eisler"
date: "11/6/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
set.seed(10)
```


# Problem 1

#### Load IRIS data from the tidyverse

```{r}
iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

*The data appears to be measurements of individual iris flowers (petal and sepal lengths and widths to the nearest 10th of a unit). Included also are species names.*

#### For numeric variables, you should fill in missing values with the mean of non-missing values. For character variables, you should fill in missing values with "virginica."

```{r}
replace_na = function(x) {
  output = vector(length = length(x))
  for (i in 1:length(x)) {
    if (is.numeric(x[i])) {
      mean_i = mean(x[!is.na(x)])
      if (!is.na(x[i])) {
        output[i] = x[i]
      } else {
        output[i] = mean_i
      }
    } else if (is.character(x[i])) {
      if (!is.na(x[i])) {
        output[i] = x[i]
      } else {
        output[i] = "virginica"
      }
    }
  }
  output
}
iris_complete = map(iris_with_missing, replace_na) %>%
  as.data.frame()
```